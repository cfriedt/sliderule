package org.sliderule.runner;

final class StudentsT {
	// produced via Matlab's tinv function
	private static final double p[] = { 0.55, 0.60, 0.70, 0.75, 0.80, 0.85, 0.90, 0.95, 0.975, 0.99, 0.995, };
	private static final double xtable[][] = {
		{ 0.158384, 0.324920, 0.509525, 0.726543, 1.000000, 1.376382, 1.962611, 3.077684, 6.313752, 12.706205, 31.820516, 63.656741,  },
		{ 0.142134, 0.288675, 0.444750, 0.617213, 0.816497, 1.060660, 1.386207, 1.885618, 2.919986, 4.302653, 6.964557, 9.924843,  },
		{ 0.136598, 0.276671, 0.424202, 0.584390, 0.764892, 0.978472, 1.249778, 1.637744, 2.353363, 3.182446, 4.540703, 5.840909,  },
		{ 0.133830, 0.270722, 0.414163, 0.568649, 0.740697, 0.940965, 1.189567, 1.533206, 2.131847, 2.776445, 3.746947, 4.604095,  },
		{ 0.132175, 0.267181, 0.408229, 0.559430, 0.726687, 0.919544, 1.155767, 1.475884, 2.015048, 2.570582, 3.364930, 4.032143,  },
		{ 0.131076, 0.264835, 0.404313, 0.553381, 0.717558, 0.905703, 1.134157, 1.439756, 1.943180, 2.446912, 3.142668, 3.707428,  },
		{ 0.130293, 0.263167, 0.401538, 0.549110, 0.711142, 0.896030, 1.119159, 1.414924, 1.894579, 2.364624, 2.997952, 3.499483,  },
		{ 0.129707, 0.261921, 0.399469, 0.545934, 0.706387, 0.888890, 1.108145, 1.396815, 1.859548, 2.306004, 2.896459, 3.355387,  },
		{ 0.129253, 0.260955, 0.397868, 0.543480, 0.702722, 0.883404, 1.099716, 1.383029, 1.833113, 2.262157, 2.821438, 3.249836,  },
		{ 0.128890, 0.260185, 0.396591, 0.541528, 0.699812, 0.879058, 1.093058, 1.372184, 1.812461, 2.228139, 2.763769, 3.169273,  },
		{ 0.128594, 0.259556, 0.395551, 0.539938, 0.697445, 0.875530, 1.087666, 1.363430, 1.795885, 2.200985, 2.718079, 3.105807,  },
		{ 0.128347, 0.259033, 0.394686, 0.538618, 0.695483, 0.872609, 1.083211, 1.356217, 1.782288, 2.178813, 2.680998, 3.054540,  },
		{ 0.128139, 0.258591, 0.393955, 0.537504, 0.693829, 0.870152, 1.079469, 1.350171, 1.770933, 2.160369, 2.650309, 3.012276,  },
		{ 0.127961, 0.258213, 0.393331, 0.536552, 0.692417, 0.868055, 1.076280, 1.345030, 1.761310, 2.144787, 2.624494, 2.976843,  },
		{ 0.127806, 0.257885, 0.392790, 0.535729, 0.691197, 0.866245, 1.073531, 1.340606, 1.753050, 2.131450, 2.602480, 2.946713,  },
		{ 0.127671, 0.257599, 0.392318, 0.535010, 0.690132, 0.864667, 1.071137, 1.336757, 1.745884, 2.119905, 2.583487, 2.920782,  },
		{ 0.127552, 0.257347, 0.391902, 0.534377, 0.689195, 0.863279, 1.069033, 1.333379, 1.739607, 2.109816, 2.566934, 2.898231,  },
		{ 0.127447, 0.257123, 0.391533, 0.533816, 0.688364, 0.862049, 1.067170, 1.330391, 1.734064, 2.100922, 2.552380, 2.878440,  },
		{ 0.127352, 0.256923, 0.391202, 0.533314, 0.687621, 0.860951, 1.065507, 1.327728, 1.729133, 2.093024, 2.539483, 2.860935,  },
		{ 0.127267, 0.256743, 0.390906, 0.532863, 0.686954, 0.859964, 1.064016, 1.325341, 1.724718, 2.085963, 2.527977, 2.845340,  },
		{ 0.127190, 0.256580, 0.390637, 0.532455, 0.686352, 0.859074, 1.062670, 1.323188, 1.720743, 2.079614, 2.517648, 2.831360,  },
		{ 0.127120, 0.256432, 0.390394, 0.532085, 0.685805, 0.858266, 1.061449, 1.321237, 1.717144, 2.073873, 2.508325, 2.818756,  },
		{ 0.127056, 0.256297, 0.390171, 0.531747, 0.685306, 0.857530, 1.060337, 1.319460, 1.713872, 2.068658, 2.499867, 2.807336,  },
		{ 0.126998, 0.256173, 0.389967, 0.531438, 0.684850, 0.856855, 1.059319, 1.317836, 1.710882, 2.063899, 2.492159, 2.796940,  },
		{ 0.126944, 0.256060, 0.389780, 0.531154, 0.684430, 0.856236, 1.058384, 1.316345, 1.708141, 2.059539, 2.485107, 2.787436,  },
		{ 0.126895, 0.255955, 0.389607, 0.530892, 0.684043, 0.855665, 1.057523, 1.314972, 1.705618, 2.055529, 2.478630, 2.778715,  },
		{ 0.126849, 0.255858, 0.389448, 0.530649, 0.683685, 0.855137, 1.056727, 1.313703, 1.703288, 2.051831, 2.472660, 2.770683,  },
		{ 0.126806, 0.255768, 0.389299, 0.530424, 0.683353, 0.854647, 1.055989, 1.312527, 1.701131, 2.048407, 2.467140, 2.763262,  },
		{ 0.126767, 0.255684, 0.389161, 0.530214, 0.683044, 0.854192, 1.055302, 1.311434, 1.699127, 2.045230, 2.462021, 2.756386,  },
		{ 0.126730, 0.255605, 0.389032, 0.530019, 0.682756, 0.853767, 1.054662, 1.310415, 1.697261, 2.042272, 2.457262, 2.749996,  },
		{ 0.126695, 0.255532, 0.388912, 0.529836, 0.682486, 0.853370, 1.054064, 1.309464, 1.695519, 2.039513, 2.452824, 2.744042,  },
		{ 0.126663, 0.255464, 0.388799, 0.529665, 0.682234, 0.852998, 1.053504, 1.308573, 1.693889, 2.036933, 2.448678, 2.738481,  },
		{ 0.126632, 0.255399, 0.388693, 0.529504, 0.681997, 0.852649, 1.052979, 1.307737, 1.692360, 2.034515, 2.444794, 2.733277,  },
		{ 0.126603, 0.255339, 0.388593, 0.529353, 0.681774, 0.852321, 1.052485, 1.306952, 1.690924, 2.032245, 2.441150, 2.728394,  },
		{ 0.126576, 0.255281, 0.388499, 0.529211, 0.681564, 0.852012, 1.052019, 1.306212, 1.689572, 2.030108, 2.437723, 2.723806,  },
		{ 0.126551, 0.255227, 0.388410, 0.529076, 0.681366, 0.851720, 1.051580, 1.305514, 1.688298, 2.028094, 2.434494, 2.719485,  },
		{ 0.126527, 0.255176, 0.388326, 0.528949, 0.681178, 0.851444, 1.051165, 1.304854, 1.687094, 2.026192, 2.431447, 2.715409,  },
		{ 0.126504, 0.255128, 0.388247, 0.528828, 0.681001, 0.851183, 1.050772, 1.304230, 1.685954, 2.024394, 2.428568, 2.711558,  },
		{ 0.126482, 0.255082, 0.388171, 0.528714, 0.680833, 0.850935, 1.050399, 1.303639, 1.684875, 2.022691, 2.425841, 2.707913,  },
		{ 0.126462, 0.255039, 0.388100, 0.528606, 0.680673, 0.850700, 1.050046, 1.303077, 1.683851, 2.021075, 2.423257, 2.704459,  },
		{ 0.126442, 0.254997, 0.388032, 0.528502, 0.680521, 0.850476, 1.049710, 1.302543, 1.682878, 2.019541, 2.420803, 2.701181,  },
		{ 0.126423, 0.254958, 0.387967, 0.528404, 0.680376, 0.850263, 1.049390, 1.302035, 1.681952, 2.018082, 2.418470, 2.698066,  },
		{ 0.126406, 0.254920, 0.387905, 0.528311, 0.680238, 0.850060, 1.049085, 1.301552, 1.681071, 2.016692, 2.416250, 2.695102,  },
		{ 0.126389, 0.254884, 0.387846, 0.528221, 0.680107, 0.849867, 1.048794, 1.301090, 1.680230, 2.015368, 2.414134, 2.692278,  },
		{ 0.126373, 0.254850, 0.387790, 0.528136, 0.679981, 0.849682, 1.048516, 1.300649, 1.679427, 2.014103, 2.412116, 2.689585,  },
		{ 0.126357, 0.254817, 0.387736, 0.528054, 0.679861, 0.849505, 1.048250, 1.300228, 1.678660, 2.012896, 2.410188, 2.687013,  },
		{ 0.126342, 0.254786, 0.387684, 0.527976, 0.679746, 0.849336, 1.047996, 1.299825, 1.677927, 2.011741, 2.408345, 2.684556,  },
		{ 0.126328, 0.254756, 0.387635, 0.527901, 0.679635, 0.849174, 1.047752, 1.299439, 1.677224, 2.010635, 2.406581, 2.682204,  },
		{ 0.126314, 0.254727, 0.387587, 0.527829, 0.679530, 0.849018, 1.047519, 1.299069, 1.676551, 2.009575, 2.404892, 2.679952,  },
		{ 0.126301, 0.254699, 0.387542, 0.527760, 0.679428, 0.848869, 1.047295, 1.298714, 1.675905, 2.008559, 2.403272, 2.677793,  },
		{ 0.126289, 0.254673, 0.387498, 0.527694, 0.679331, 0.848726, 1.047080, 1.298373, 1.675285, 2.007584, 2.401718, 2.675722,  },
		{ 0.126277, 0.254647, 0.387456, 0.527631, 0.679237, 0.848588, 1.046873, 1.298045, 1.674689, 2.006647, 2.400225, 2.673734,  },
		{ 0.126265, 0.254623, 0.387416, 0.527569, 0.679147, 0.848456, 1.046674, 1.297730, 1.674116, 2.005746, 2.398790, 2.671823,  },
		{ 0.126254, 0.254599, 0.387377, 0.527510, 0.679060, 0.848328, 1.046483, 1.297426, 1.673565, 2.004879, 2.397410, 2.669985,  },
		{ 0.126243, 0.254576, 0.387339, 0.527454, 0.678977, 0.848205, 1.046298, 1.297134, 1.673034, 2.004045, 2.396081, 2.668216,  },
		{ 0.126233, 0.254554, 0.387303, 0.527399, 0.678896, 0.848087, 1.046120, 1.296853, 1.672522, 2.003241, 2.394801, 2.666512,  },
		{ 0.126222, 0.254533, 0.387268, 0.527346, 0.678818, 0.847973, 1.045949, 1.296581, 1.672029, 2.002465, 2.393568, 2.664870,  },
		{ 0.126213, 0.254512, 0.387234, 0.527295, 0.678743, 0.847862, 1.045783, 1.296319, 1.671553, 2.001717, 2.392377, 2.663287,  },
		{ 0.126203, 0.254493, 0.387202, 0.527246, 0.678671, 0.847756, 1.045623, 1.296066, 1.671093, 2.000995, 2.391229, 2.661759,  },
		{ 0.126194, 0.254473, 0.387170, 0.527198, 0.678601, 0.847653, 1.045469, 1.295821, 1.670649, 2.000298, 2.390119, 2.660283,  },
		{ 0.126186, 0.254455, 0.387140, 0.527152, 0.678533, 0.847553, 1.045320, 1.295585, 1.670219, 1.999624, 2.389047, 2.658857,  },
		{ 0.126177, 0.254437, 0.387111, 0.527108, 0.678467, 0.847457, 1.045175, 1.295356, 1.669804, 1.998972, 2.388011, 2.657479,  },
		{ 0.126169, 0.254420, 0.387082, 0.527064, 0.678404, 0.847364, 1.045035, 1.295134, 1.669402, 1.998341, 2.387008, 2.656145,  },
		{ 0.126161, 0.254403, 0.387054, 0.527023, 0.678342, 0.847274, 1.044900, 1.294920, 1.669013, 1.997730, 2.386037, 2.654854,  },
		{ 0.126153, 0.254387, 0.387028, 0.526982, 0.678283, 0.847186, 1.044768, 1.294712, 1.668636, 1.997138, 2.385097, 2.653604,  },
		{ 0.126146, 0.254371, 0.387002, 0.526943, 0.678225, 0.847101, 1.044641, 1.294511, 1.668271, 1.996564, 2.384186, 2.652394,  },
		{ 0.126139, 0.254355, 0.386977, 0.526905, 0.678169, 0.847019, 1.044518, 1.294315, 1.667916, 1.996008, 2.383302, 2.651220,  },
		{ 0.126132, 0.254341, 0.386952, 0.526868, 0.678115, 0.846939, 1.044398, 1.294126, 1.667572, 1.995469, 2.382446, 2.650081,  },
		{ 0.126125, 0.254326, 0.386928, 0.526832, 0.678062, 0.846862, 1.044281, 1.293942, 1.667239, 1.994945, 2.381615, 2.648977,  },
		{ 0.126118, 0.254312, 0.386905, 0.526797, 0.678011, 0.846786, 1.044169, 1.293763, 1.666914, 1.994437, 2.380807, 2.647905,  },
		{ 0.126112, 0.254299, 0.386883, 0.526763, 0.677961, 0.846713, 1.044059, 1.293589, 1.666600, 1.993943, 2.380024, 2.646863,  },
		{ 0.126105, 0.254285, 0.386861, 0.526730, 0.677912, 0.846642, 1.043952, 1.293421, 1.666294, 1.993464, 2.379262, 2.645852,  },
		{ 0.126099, 0.254272, 0.386840, 0.526698, 0.677865, 0.846573, 1.043848, 1.293256, 1.665996, 1.992997, 2.378522, 2.644869,  },
		{ 0.126093, 0.254260, 0.386819, 0.526667, 0.677820, 0.846506, 1.043747, 1.293097, 1.665707, 1.992543, 2.377802, 2.643913,  },
		{ 0.126088, 0.254248, 0.386799, 0.526637, 0.677775, 0.846440, 1.043649, 1.292941, 1.665425, 1.992102, 2.377102, 2.642983,  },
		{ 0.126082, 0.254236, 0.386780, 0.526607, 0.677732, 0.846376, 1.043554, 1.292790, 1.665151, 1.991673, 2.376420, 2.642078,  },
		{ 0.126076, 0.254224, 0.386761, 0.526578, 0.677689, 0.846314, 1.043461, 1.292643, 1.664885, 1.991254, 2.375757, 2.641198,  },
		{ 0.126071, 0.254213, 0.386742, 0.526550, 0.677648, 0.846254, 1.043370, 1.292500, 1.664625, 1.990847, 2.375111, 2.640340,  },
		{ 0.126066, 0.254202, 0.386724, 0.526523, 0.677608, 0.846195, 1.043282, 1.292360, 1.664371, 1.990450, 2.374482, 2.639505,  },
		{ 0.126061, 0.254191, 0.386707, 0.526497, 0.677569, 0.846137, 1.043195, 1.292224, 1.664125, 1.990063, 2.373868, 2.638691,  },
		{ 0.126056, 0.254181, 0.386690, 0.526471, 0.677531, 0.846081, 1.043111, 1.292091, 1.663884, 1.989686, 2.373270, 2.637897,  },
		{ 0.126051, 0.254171, 0.386673, 0.526445, 0.677493, 0.846027, 1.043029, 1.291961, 1.663649, 1.989319, 2.372687, 2.637123,  },
		{ 0.126046, 0.254161, 0.386657, 0.526421, 0.677457, 0.845973, 1.042949, 1.291835, 1.663420, 1.988960, 2.372119, 2.636369,  },
		{ 0.126042, 0.254151, 0.386641, 0.526396, 0.677422, 0.845921, 1.042871, 1.291711, 1.663197, 1.988610, 2.371564, 2.635632,  },
		{ 0.126037, 0.254142, 0.386625, 0.526373, 0.677387, 0.845870, 1.042795, 1.291591, 1.662978, 1.988268, 2.371022, 2.634914,  },
		{ 0.126033, 0.254132, 0.386610, 0.526350, 0.677353, 0.845821, 1.042721, 1.291473, 1.662765, 1.987934, 2.370493, 2.634212,  },
		{ 0.126029, 0.254123, 0.386595, 0.526327, 0.677320, 0.845772, 1.042648, 1.291358, 1.662557, 1.987608, 2.369977, 2.633527,  },
		{ 0.126025, 0.254114, 0.386580, 0.526305, 0.677288, 0.845725, 1.042577, 1.291246, 1.662354, 1.987290, 2.369472, 2.632858,  },
		{ 0.126020, 0.254106, 0.386566, 0.526284, 0.677256, 0.845679, 1.042508, 1.291136, 1.662155, 1.986979, 2.368979, 2.632204,  },
		{ 0.126016, 0.254097, 0.386552, 0.526263, 0.677225, 0.845633, 1.042440, 1.291029, 1.661961, 1.986675, 2.368497, 2.631565,  },
		{ 0.126013, 0.254089, 0.386539, 0.526242, 0.677195, 0.845589, 1.042373, 1.290924, 1.661771, 1.986377, 2.368026, 2.630940,  },
		{ 0.126009, 0.254081, 0.386526, 0.526222, 0.677166, 0.845546, 1.042308, 1.290821, 1.661585, 1.986086, 2.367566, 2.630330,  },
		{ 0.126005, 0.254073, 0.386513, 0.526203, 0.677137, 0.845503, 1.042245, 1.290721, 1.661404, 1.985802, 2.367115, 2.629732,  },
		{ 0.126001, 0.254065, 0.386500, 0.526184, 0.677109, 0.845462, 1.042183, 1.290623, 1.661226, 1.985523, 2.366674, 2.629148,  },
		{ 0.125998, 0.254058, 0.386487, 0.526165, 0.677081, 0.845421, 1.042122, 1.290527, 1.661052, 1.985251, 2.366243, 2.628576,  },
		{ 0.125994, 0.254050, 0.386475, 0.526146, 0.677054, 0.845381, 1.042062, 1.290432, 1.660881, 1.984984, 2.365821, 2.628016,  },
		{ 0.125991, 0.254043, 0.386463, 0.526128, 0.677027, 0.845343, 1.042004, 1.290340, 1.660715, 1.984723, 2.365407, 2.627468,  },
		{ 0.125987, 0.254036, 0.386452, 0.526111, 0.677001, 0.845304, 1.041947, 1.290250, 1.660551, 1.984467, 2.365002, 2.626931,  },
		{ 0.125984, 0.254029, 0.386440, 0.526093, 0.676976, 0.845267, 1.041891, 1.290161, 1.660391, 1.984217, 2.364606, 2.626405,  },
		{ 0.125981, 0.254022, 0.386429, 0.526076, 0.676951, 0.845230, 1.041836, 1.290075, 1.660234, 1.983972, 2.364217, 2.625891,  },
		{ 0.125978, 0.254015, 0.386418, 0.526060, 0.676927, 0.845195, 1.041782, 1.289990, 1.660081, 1.983731, 2.363837, 2.625386,  },
		{ 0.125975, 0.254009, 0.386407, 0.526043, 0.676903, 0.845159, 1.041729, 1.289907, 1.659930, 1.983495, 2.363464, 2.624891,  },
		{ 0.125972, 0.254002, 0.386397, 0.526027, 0.676879, 0.845125, 1.041678, 1.289825, 1.659782, 1.983264, 2.363098, 2.624407,  },
		{ 0.125969, 0.253996, 0.386386, 0.526012, 0.676856, 0.845091, 1.041627, 1.289745, 1.659637, 1.983038, 2.362739, 2.623932,  },
		{ 0.125966, 0.253990, 0.386376, 0.525996, 0.676833, 0.845058, 1.041577, 1.289666, 1.659495, 1.982815, 2.362388, 2.623465,  },
		{ 0.125963, 0.253984, 0.386366, 0.525981, 0.676811, 0.845025, 1.041529, 1.289589, 1.659356, 1.982597, 2.362043, 2.623008,  },
		{ 0.125960, 0.253978, 0.386356, 0.525966, 0.676790, 0.844993, 1.041481, 1.289514, 1.659219, 1.982383, 2.361704, 2.622560,  },
		{ 0.125957, 0.253972, 0.386347, 0.525952, 0.676768, 0.844962, 1.041434, 1.289439, 1.659085, 1.982173, 2.361372, 2.622120,  },
		{ 0.125954, 0.253966, 0.386337, 0.525938, 0.676747, 0.844931, 1.041388, 1.289367, 1.658953, 1.981967, 2.361046, 2.621688,  },
		{ 0.125952, 0.253961, 0.386328, 0.525924, 0.676727, 0.844901, 1.041342, 1.289295, 1.658824, 1.981765, 2.360726, 2.621265,  },
		{ 0.125949, 0.253955, 0.386319, 0.525910, 0.676706, 0.844871, 1.041298, 1.289225, 1.658697, 1.981567, 2.360412, 2.620849,  },
		{ 0.125947, 0.253950, 0.386310, 0.525896, 0.676687, 0.844842, 1.041254, 1.289156, 1.658573, 1.981372, 2.360104, 2.620440,  },
		{ 0.125944, 0.253944, 0.386301, 0.525883, 0.676667, 0.844814, 1.041212, 1.289088, 1.658450, 1.981180, 2.359801, 2.620039,  },
		{ 0.125942, 0.253939, 0.386293, 0.525870, 0.676648, 0.844786, 1.041169, 1.289022, 1.658330, 1.980992, 2.359504, 2.619645,  },
		{ 0.125939, 0.253934, 0.386284, 0.525857, 0.676629, 0.844758, 1.041128, 1.288957, 1.658212, 1.980808, 2.359212, 2.619258,  },
		{ 0.125937, 0.253929, 0.386276, 0.525845, 0.676611, 0.844731, 1.041087, 1.288892, 1.658096, 1.980626, 2.358924, 2.618878,  },
		{ 0.125934, 0.253924, 0.386268, 0.525832, 0.676592, 0.844704, 1.041047, 1.288829, 1.657982, 1.980448, 2.358642, 2.618504,  },
		{ 0.125932, 0.253919, 0.386260, 0.525820, 0.676575, 0.844678, 1.041008, 1.288767, 1.657870, 1.980272, 2.358365, 2.618137,  },
		{ 0.125930, 0.253914, 0.386252, 0.525808, 0.676557, 0.844652, 1.040970, 1.288706, 1.657759, 1.980100, 2.358093, 2.617776,  },
		{ 0.125928, 0.253910, 0.386244, 0.525796, 0.676540, 0.844627, 1.040932, 1.288646, 1.657651, 1.979930, 2.357825, 2.617421,  },
	};
	
	private StudentsT() {}

	/**
	 * <p>Evaluate the cumulative distribution function of the <a href="http://en.wikipedia.org/wiki/Student%27s_t-distribution">Student's t distribution</a>.</p> 
	 * @param n sample size such that there are {@code n-1} degrees of freedom. {@code 2 <= n}
	 * @param x value of random variable {@code X}
	 * @return {@code p = Pr( X <= x | n-1 )}
	 * @see
	 *   <ul>
	 *     <li>Chapra, Steven C., and Canale, Raymond P. Numerical Methods for Engineers, 4th Ed. Toronto: McGraw-Hill, 2002. pp 435. Print.</li>
	 *     <li>DeGroot, Morris H., and Schervish, Mark J. Probability and Statistics, 3rd Ed. Toronto: Addison-Wesley, 2002. pp. 776-777. Print.</li>
	 *   </ul>  
	 */
	public static double cdf( int n, double x ) {
		if ( n < 2 ) {
			throw new IllegalArgumentException();
		}

		// Use symmetry property rather than double size of xtable
		boolean negative = x < 0;
		x = negative ? -x : x;

		double r = 0.5D;
		double[] xrow = xtable[ n - 2 ];
		int i=0;
		for( double xx: xrow ) {
			if ( xx < x ) {
				double alpha = 2 * ( 1 - p[ i ] ); 
				r = 1 - alpha;
				i++;
			} else {
				break;
			}
		}
		r = negative ? ( 1 - r ) : r;
		return r;
	}

	/**
	 * <p>Evaluate the inverse of the cumulative distribution function of the <a href="http://en.wikipedia.org/wiki/Student%27s_t-distribution">Student's t distribution</a></p> 
	 * @param n sample size such that there are {@code n-1} degrees of freedom. {@code 2 <= n}
	 * @param p level of confidence. {@code 0 <= p <= 1}
	 * @return {@code x} &ni; {@code Pr( X <= x | n-1 ) = {@code p}
	 * @see
	 *   <ul>
	 *     <li>Chapra, Steven C., and Canale, Raymond P. Numerical Methods for Engineers, 4th Ed. Toronto: McGraw-Hill, 2002. pp 435. Print.</li>
	 *     <li>DeGroot, Morris H., and Schervish, Mark J. Probability and Statistics, 3rd Ed. Toronto: Addison-Wesley, 2002. pp. 776-777. Print.</li>
	 *   </ul>
	 */
	static double inv( int n, double p ) {
		if ( p < 0 || p > 1 ) {
			throw new IllegalArgumentException();
		}
		if ( n < 2 ) {
			throw new IllegalArgumentException();
		}
		// probabilities converge after this point
		n = ( n >= xtable.length - 1 ) ? xtable.length - 1 : n;
		
		double r = 0;
		boolean negative = p < 0.50;
		double alpha = negative ? p : ( 1D - p );
		double half_alpha = alpha / 2;
		double pvalue = 1 - half_alpha;
		double[] xrow = xtable[ n - 2 ];
		int i;
		for( i=0; i<StudentsT.p.length; i++ ) {
			if ( pvalue < StudentsT.p[ i ] ) {
				break;
			}
		}
		r = negative ? -xrow[ i ] : xrow[ i ];
		return r;
	}
}
